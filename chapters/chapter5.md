فصل ۵:عیوب و طراحی
متأسفانه، هیچ برنامه‌نویسی کامل نیست. برنامه‌نویسان خوب به‌طور متوسط با هر ۱۰۰ خط کدی که می‌نویسند، یک عیب در برنامه ایجاد می‌کنند. بهترین برنامه‌نویسان، در بهترین شرایط ممکن، با هر ۱۰۰۰ خط کدی که می‌نویسند، یک عیب وارد می‌کنند.
به عبارت دیگر، مهم نیست چقدر خوب یا بد هستید، هرچه بیشتر کدنویسی کنید، تعداد عیوب بیشتری ایجاد خواهید کرد. این به ما اجازه می‌دهد تا قانونی به نام قانون احتمال عیب را بیان کنیم:
احتمال ایجاد عیب در برنامه شما متناسب با اندازه تغییراتی است که در آن ایجاد می‌کنید.
این موضوع مهم است، زیرا عیوب هدف اصلی نرم‌افزار ما یعنی کمک به مردم را نقض می‌کنند و بنابراین باید از آن‌ها اجتناب شود. همچنین، رفع عیوب نوعی نگهداری است. بنابراین، افزایش تعداد عیوب باعث افزایش تلاش‌های نگهداری می‌شود.
با استفاده از این قانون، بدون نیاز به پیش‌بینی آینده، می‌توانیم فوراً ببینیم که ایجاد تغییرات کوچک احتمالاً به تلاش نگهداری کمتری نسبت به ایجاد تغییرات بزرگ منجر می‌شود. تغییرات کوچک = عیوب کمتر = نگهداری کمتر.
این قانون گاهی به شکلی غیررسمی‌تر به این صورت بیان می‌شود: "شما نمی‌توانید باگ جدیدی وارد کنید اگر کد جدیدی اضافه نکنید یا کد فعلی را تغییر ندهید."
نکته جالب درباره این قانون این است که به نظر می‌رسد با قانون تغییر در تضاد است—نرم‌افزار شما باید تغییر کند، اما تغییر آن باعث ایجاد عیوب می‌شود. این یک تضاد واقعی است و متعادل کردن این قوانین نیاز به هوش شما به‌عنوان یک طراح نرم‌افزار دارد. در واقع، این تضاد به ما توضیح می‌دهد که چرا به طراحی نیاز داریم و در واقع به ما می‌گوید که طراحی ایده‌آل چیست:
بهترین طراحی، طراحی‌ای است که امکان بیشترین تغییر در محیط را با کمترین تغییر در نرم‌افزار فراهم می‌کند.
و این خلاصه بسیاری از آنچه که درباره طراحی نرم‌افزار خوب امروزه شناخته شده است.
اگر مشکلی نیست...
بسیار خب، شما نمی‌توانید باگ جدیدی به برنامه خود اضافه کنید اگر کدی اضافه یا اصلاح نکنید، و این یک قانون اصلی در طراحی نرم‌افزار است. اما همچنین یک قانون بسیار مهم مرتبط وجود دارد که بسیاری از مهندسان نرم‌افزار آن را به یک شکل یا شکل دیگر شنیده‌اند، اما گاهی فراموش می‌کنند:
هرگز چیزی را "اصلاح" نکنید مگر اینکه دچار مشکل شده باشد و شواهدی داشته باشید که نشان دهد آن مشکل واقعاً وجود دارد.
مهم است که قبل از رسیدگی به مشکلات، شواهدی از وجود آن‌ها داشته باشید. در غیر این صورت، ممکن است ویژگی‌هایی توسعه دهید که هیچ مشکلی را حل نمی‌کنند، یا ممکن است چیزهایی را "اصلاح" کنید که اصلاً مشکلی نداشتند.
اگر بدون شواهد مشکلات را اصلاح کنید، احتمالاً چیزهای دیگر را خراب خواهید کرد. شما تغییراتی در سیستم خود ایجاد می‌کنید که باعث ایجاد عیوب جدید همراه با آن‌ها می‌شود. و نه فقط این، بلکه زمان خود را هدر می‌دهید و پیچیدگی غیرضروری به برنامه خود اضافه می‌کنید.
خب، چه چیزی به‌عنوان "شواهد" به حساب می‌آید؟ فرض کنید پنج کاربر گزارش می‌دهند که وقتی دکمه قرمز را فشار می‌دهند، برنامه شما کرش می‌کند. خب، این شواهد کافی است! یا ممکن است خودتان دکمه قرمز را فشار دهید و متوجه شوید که برنامه کرش می‌کند.
با این حال، فقط به این دلیل که یک کاربر چیزی را گزارش می‌دهد به این معنی نیست که آن واقعاً یک مشکل است. گاهی اوقات کاربر فقط متوجه نمی‌شود که برنامه شما از قبل آن ویژگی را دارد و بنابراین به‌طور غیرضروری از شما می‌خواهد که چیزی را پیاده‌سازی کنید. برای مثال، فرض کنید شما برنامه‌ای می‌نویسید که یک لیست از کلمات را به ترتیب حروف الفبا مرتب می‌کند، و کاربری از شما می‌خواهد ویژگی‌ای اضافه کنید که لیستی از حروف را به ترتیب الفبا مرتب کند. برنامه شما از قبل این کار را انجام می‌دهد. در واقع، حتی بیشتر از آنچه که درخواست شده انجام می‌دهد—این اغلب در چنین درخواست‌های گیج‌کننده‌ای اتفاق می‌افتد. در این حالت، کاربر ممکن است فکر کند مشکلی وجود دارد، درحالی‌که واقعاً مشکلی وجود ندارد. او ممکن است حتی "شواهدی" ارائه کند که نمی‌تواند لیستی از حروف را مرتب کند، درحالی‌که مشکل فقط این است که او متوجه نشده باید از ویژگی مرتب‌سازی کلمات استفاده کند.

اگر درخواست‌های زیادی مانند موارد بالا دریافت می‌کنید، به این معنی است که کاربران نمی‌توانند به راحتی ویژگی‌های مورد نیاز خود را در برنامه شما پیدا کنند. این چیزی است که باید آن را اصلاح کنید.

گاهی اوقات کاربری گزارش می‌دهد که باگی وجود دارد، درحالی‌که در واقع برنامه دقیقاً همان‌طور که شما قصد داشتید رفتار می‌کند. در این حالت، این مسئله به قانون اکثریت مربوط است. اگر تعداد قابل‌توجهی از کاربران فکر می‌کنند که این رفتار یک باگ است، پس یک باگ است. اگر فقط تعداد کمی (مانند یک یا دو نفر) فکر می‌کنند که یک باگ است، پس باگ نیست.
معروف‌ترین اشتباه در این زمینه چیزی است که ما آن را "بهینه‌سازی زودهنگام" می‌نامیم. یعنی، برخی توسعه‌دهندگان شروع می‌کنند به اصلاح کدشان تا آن را سریع‌تر کند، و وقت قابل توجهی صرف بهینه‌سازی می‌کنند درحالیکه هنوز مطمئن نیستند کد آن‌ها کند است! این مانند این است که یک مؤسسه خیریه به افراد ثروتمند غذا ارسال کند و بگوید: "ما فقط می‌خواستیم به مردم کمک کنیم!" غیرمنطقی است، نه؟ آن‌ها در حال حل مشکلی هستند که اصلاً وجود ندارد.
تنها بخش‌هایی از برنامه شما که باید نگران سرعت آن‌ها باشید، دقیقاً بخش‌هایی هستند که می‌توانید نشان دهید برای کاربران شما یک مشکل واقعی در عملکرد ایجاد کرده‌اند. برای بقیه کد، دغدغه اصلی انعطاف‌پذیری و سادگی است، نه سریع‌تر کردن آن.
راه‌های بی‌نهایتی برای نقض این قانون وجود دارد، اما راه پیروی از آن ساده است: فقط شواهد واقعی داشته باشید که یک مشکل معتبر است قبل از اینکه به آن بپردازید.
تکرار نکنید
این احتمالاً معروف‌ترین قانون در طراحی نرم‌افزار است. شما احتمالاً آن را از قبل می‌دانید. اما این قانون معتبر است، بنابراین اینجا ذکر شده است:
در هر سیستم خاص، هر قطعه اطلاعاتی باید به‌طور ایده‌آل فقط یک‌بار وجود داشته باشد.
فرض کنید فیلدی به نام "رمز عبور" دارید که در ۱۰۰ صفحه از رابط کاربری برنامه شما ظاهر می‌شود. چه می‌شود اگر بخواهید نام این فیلد را به "کد عبور" تغییر دهید؟ خب، اگر نام فیلد را در یک مکان مرکزی در کد خود ذخیره کرده باشید، رفع آن فقط به یک تغییر در یک خط کد نیاز خواهد داشت. اما اگر کلمه "رمز عبور" را به‌صورت دستی در همه ۱۰۰ صفحه رابط کاربری وارد کرده باشید، برای اصلاح آن به ۱۰۰ تغییر نیاز خواهید داشت.
این قانون در مورد بلوک‌های کد نیز صدق می‌کند. شما نباید بلوک‌های کد را کپی و پیست کنید. در عوض، باید از تکنولوژی‌های مختلف برنامه‌نویسی (فراخوانی کردن یک تابع یا دستوراتی مانند use و include) استفاده کنید که به یک قطعه کد اجازه می‌دهند از کد دیگر "استفاده کند"، آن را "فراخوانی" کند، یا آن را "شامل" کند.
یکی از دلایل خوب برای پیروی از این قانون، قانون احتمال عیب است. اگر بتوانیم از کد قدیمی استفاده مجدد کنیم، لازم نیست هنگام افزودن ویژگی‌های جدید، کد زیادی بنویسیم یا تغییر دهیم، بنابراین عیوب کمتری وارد می‌کنیم.
این قانون همچنین به ما در انعطاف‌پذیری طراحی کمک می‌کند. اگر نیاز به تغییر در نحوه کار برنامه داشته باشیم، می‌توانیم مقداری از کد را فقط در یک مکان تغییر دهیم، به‌جای اینکه کل برنامه را مرور کرده و چندین تغییر انجام دهیم.
بسیاری از طراحی‌های خوب بر اساس این قانون استوار هستند. یعنی هرچه بیشتر بتوانید در هوشمندانه استفاده کردن از کدهای موجود و متمرکز کردن اطلاعات پیشرفت کنید، طراحی شما بهتر خواهد بود. این یکی دیگر از زمینه‌هایی است که هوش شما واقعاً در برنامه‌نویسی نقش دارد.

